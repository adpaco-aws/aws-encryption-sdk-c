
<html>
<head>
<title>verification/cbmc/sources/utils.c</title>
<link rel="stylesheet" type="text/css" href="../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /**</div><div id="2" class="line none">    2  * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.</div><div id="3" class="line none">    3  * SPDX-License-Identifier: Apache-2.0.</div><div id="4" class="line none">    4  */</div><div id="5" class="line none">    5 </div><div id="6" class="line none">    6 #include &lt;utils.h&gt;</div><div id="7" class="line none">    7 </div><div id="8" class="line none">    8 bool <a href="utils.c.html#8">aws_byte_buf_contents_match</a>(const struct <a href="../aws-c-common/include/aws/common/byte_buf.h.html#25">aws_byte_buf</a> *const lhs, const struct <a href="../aws-c-common/include/aws/common/byte_buf.h.html#25">aws_byte_buf</a> *const rhs) {</div><div id="9" class="line none">    9     if (!lhs || !rhs) /* Filter null pointers */</div><div id="10" class="line none">   10         return (lhs == rhs); /* Return true if both null */</div><div id="11" class="line none">   11     if (lhs-&gt;<a href="../aws-c-common/include/aws/common/byte_buf.h.html#27">len</a> != rhs-&gt;<a href="../aws-c-common/include/aws/common/byte_buf.h.html#27">len</a>)</div><div id="12" class="line none">   12         return false;</div><div id="13" class="line none">   13     if (lhs-&gt;<a href="../aws-c-common/include/aws/common/byte_buf.h.html#27">len</a> &gt; 0) {</div><div id="14" class="line none">   14         for (size_t i = 0; i &lt; lhs-&gt;<a href="../aws-c-common/include/aws/common/byte_buf.h.html#27">len</a>; ++i) {</div><div id="15" class="line none">   15             if (lhs-&gt;<a href="../aws-c-common/include/aws/common/byte_buf.h.html#28">buffer</a>[i] != rhs-&gt;<a href="../aws-c-common/include/aws/common/byte_buf.h.html#28">buffer</a>[i]) { </div><div id="16" class="line none">   16                 return false;</div><div id="17" class="line none">   17             }</div><div id="18" class="line none">   18         }</div><div id="19" class="line none">   19     }</div><div id="20" class="line none">   20     return true;</div><div id="21" class="line none">   21 }</div><div id="22" class="line none">   22 </div><div id="23" class="line none">   23 bool <a href="utils.c.html#23">key_contents_match</a>(const struct <a href="../../../include/aws/cryptosdk/private/cipher.h.html#43">content_key</a> *ckey, const struct <a href="../../../include/aws/cryptosdk/private/cipher.h.html#39">data_key</a> *dkey, const size_t max_len) {</div><div id="24" class="line hit">   24     if (!ckey || !dkey)</div><div id="25" class="line missed">   25         return (ckey == dkey);</div><div id="26" class="line both">   26     if (!ckey-&gt;<a href="../../../include/aws/cryptosdk/private/cipher.h.html#40">keybuf</a> || !dkey-&gt;<a href="../../../include/aws/cryptosdk/private/cipher.h.html#40">keybuf</a>)</div><div id="27" class="line missed">   27         return (ckey-&gt;<a href="../../../include/aws/cryptosdk/private/cipher.h.html#40">keybuf</a> == dkey-&gt;<a href="../../../include/aws/cryptosdk/private/cipher.h.html#40">keybuf</a>);</div><div id="28" class="line hit">   28     for (size_t i = 0; i &lt; max_len; ++i) {</div><div id="29" class="line hit">   29         if (ckey-&gt;<a href="../../../include/aws/cryptosdk/private/cipher.h.html#40">keybuf</a>[i] != dkey-&gt;<a href="../../../include/aws/cryptosdk/private/cipher.h.html#40">keybuf</a>[i])</div><div id="30" class="line missed">   30            return false;</div><div id="31" class="line hit">   31     }</div><div id="32" class="line hit">   32     return true;</div><div id="33" class="line hit">   33 }</div>
</div>
</body>
</html>
