
<html>
<head>
<title>verification/cbmc/aws-c-common/include/aws/common/math.cbmc.inl</title>
<link rel="stylesheet" type="text/css" href="../../../../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 #ifndef AWS_COMMON_MATH_CBMC_INL</div><div id="2" class="line none">    2 #define AWS_COMMON_MATH_CBMC_INL</div><div id="3" class="line none">    3 </div><div id="4" class="line none">    4 /**</div><div id="5" class="line none">    5  * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.</div><div id="6" class="line none">    6  * SPDX-License-Identifier: Apache-2.0.</div><div id="7" class="line none">    7  */</div><div id="8" class="line none">    8 </div><div id="9" class="line none">    9 /*</div><div id="10" class="line none">   10  * This header is already included, but include it again to make editor</div><div id="11" class="line none">   11  * highlighting happier.</div><div id="12" class="line none">   12  */</div><div id="13" class="line none">   13 #include &lt;aws/common/common.h&gt;</div><div id="14" class="line none">   14 </div><div id="15" class="line none">   15 AWS_EXTERN_C_BEGIN</div><div id="16" class="line none">   16 </div><div id="17" class="line none">   17 /* This header does safe operations. Supressing the checks within these functions</div><div id="18" class="line none">   18  * avoids unnecessary CBMC assertions</div><div id="19" class="line none">   19  */</div><div id="20" class="line none">   20 #pragma CPROVER check push</div><div id="21" class="line none">   21 #pragma CPROVER check disable "unsigned-overflow"</div><div id="22" class="line none">   22 </div><div id="23" class="line none">   23 /**</div><div id="24" class="line none">   24  * Multiplies a * b. If the result overflows, returns 2^64 - 1.</div><div id="25" class="line none">   25  */</div><div id="26" class="line none">   26 AWS_STATIC_IMPL uint64_t <a href="math.cbmc.inl.html#26">aws_mul_u64_saturating</a>(uint64_t a, uint64_t b) {</div><div id="27" class="line none">   27     if (__CPROVER_overflow_mult(a, b))</div><div id="28" class="line none">   28         return UINT64_MAX;</div><div id="29" class="line none">   29     return a * b;</div><div id="30" class="line none">   30 }</div><div id="31" class="line none">   31 </div><div id="32" class="line none">   32 /**</div><div id="33" class="line none">   33  * If a * b overflows, returns AWS_OP_ERR; otherwise multiplies</div><div id="34" class="line none">   34  * a * b, returns the result in *r, and returns AWS_OP_SUCCESS.</div><div id="35" class="line none">   35  */</div><div id="36" class="line none">   36 AWS_STATIC_IMPL int <a href="math.cbmc.inl.html#36">aws_mul_u64_checked</a>(uint64_t a, uint64_t b, uint64_t *<a href="../../../../sources/openssl/ec_override.c.html#282">r</a>) {</div><div id="37" class="line none">   37     if (__CPROVER_overflow_mult(a, b))</div><div id="38" class="line none">   38         return <a href="error.inl.html#17">aws_raise_error</a>(<a href="error.h.html#148">AWS_ERROR_OVERFLOW_DETECTED</a>);</div><div id="39" class="line none">   39     *<a href="../../../../sources/openssl/ec_override.c.html#282">r</a> = a * b;</div><div id="40" class="line none">   40     return <a href="error.h.html#15">AWS_OP_SUCCESS</a>;</div><div id="41" class="line none">   41 }</div><div id="42" class="line none">   42 </div><div id="43" class="line none">   43 /**</div><div id="44" class="line none">   44  * Multiplies a * b. If the result overflows, returns 2^32 - 1.</div><div id="45" class="line none">   45  */</div><div id="46" class="line none">   46 AWS_STATIC_IMPL uint32_t <a href="math.cbmc.inl.html#46">aws_mul_u32_saturating</a>(uint32_t a, uint32_t b) {</div><div id="47" class="line none">   47     if (__CPROVER_overflow_mult(a, b))</div><div id="48" class="line none">   48         return UINT32_MAX;</div><div id="49" class="line none">   49     return a * b;</div><div id="50" class="line none">   50 }</div><div id="51" class="line none">   51 </div><div id="52" class="line none">   52 /**</div><div id="53" class="line none">   53  * If a * b overflows, returns AWS_OP_ERR; otherwise multiplies</div><div id="54" class="line none">   54  * a * b, returns the result in *r, and returns AWS_OP_SUCCESS.</div><div id="55" class="line none">   55  */</div><div id="56" class="line none">   56 AWS_STATIC_IMPL int <a href="math.cbmc.inl.html#56">aws_mul_u32_checked</a>(uint32_t a, uint32_t b, uint32_t *<a href="../../../../sources/openssl/ec_override.c.html#282">r</a>) {</div><div id="57" class="line none">   57     if (__CPROVER_overflow_mult(a, b))</div><div id="58" class="line none">   58         return <a href="error.inl.html#17">aws_raise_error</a>(<a href="error.h.html#148">AWS_ERROR_OVERFLOW_DETECTED</a>);</div><div id="59" class="line none">   59     *<a href="../../../../sources/openssl/ec_override.c.html#282">r</a> = a * b;</div><div id="60" class="line none">   60     return <a href="error.h.html#15">AWS_OP_SUCCESS</a>;</div><div id="61" class="line none">   61 }</div><div id="62" class="line none">   62 </div><div id="63" class="line none">   63 /**</div><div id="64" class="line none">   64  * Adds a + b.  If the result overflows returns 2^64 - 1.</div><div id="65" class="line none">   65  */</div><div id="66" class="line none">   66 AWS_STATIC_IMPL uint64_t <a href="math.cbmc.inl.html#66">aws_add_u64_saturating</a>(uint64_t a, uint64_t b) {</div><div id="67" class="line none">   67     if (__CPROVER_overflow_plus(a, b))</div><div id="68" class="line none">   68         return UINT64_MAX;</div><div id="69" class="line none">   69     return a + b;</div><div id="70" class="line none">   70 }</div><div id="71" class="line none">   71 </div><div id="72" class="line none">   72 /**</div><div id="73" class="line none">   73  * If a + b overflows, returns AWS_OP_ERR; otherwise adds</div><div id="74" class="line none">   74  * a + b, returns the result in *r, and returns AWS_OP_SUCCESS.</div><div id="75" class="line none">   75  */</div><div id="76" class="line none">   76 AWS_STATIC_IMPL int <a href="math.cbmc.inl.html#76">aws_add_u64_checked</a>(uint64_t a, uint64_t b, uint64_t *<a href="../../../../sources/openssl/ec_override.c.html#282">r</a>) {</div><div id="77" class="line none">   77     if (__CPROVER_overflow_plus(a, b))</div><div id="78" class="line none">   78         return <a href="error.inl.html#17">aws_raise_error</a>(<a href="error.h.html#148">AWS_ERROR_OVERFLOW_DETECTED</a>);</div><div id="79" class="line none">   79     *<a href="../../../../sources/openssl/ec_override.c.html#282">r</a> = a + b;</div><div id="80" class="line none">   80     return <a href="error.h.html#15">AWS_OP_SUCCESS</a>;</div><div id="81" class="line none">   81 }</div><div id="82" class="line none">   82 </div><div id="83" class="line none">   83 /**</div><div id="84" class="line none">   84  * Adds a + b. If the result overflows returns 2^32 - 1.</div><div id="85" class="line none">   85  */</div><div id="86" class="line none">   86 AWS_STATIC_IMPL uint32_t <a href="math.cbmc.inl.html#86">aws_add_u32_saturating</a>(uint32_t a, uint32_t b) {</div><div id="87" class="line none">   87     if (__CPROVER_overflow_plus(a, b))</div><div id="88" class="line none">   88         return UINT32_MAX;</div><div id="89" class="line none">   89     return a + b;</div><div id="90" class="line none">   90 }</div><div id="91" class="line none">   91 </div><div id="92" class="line none">   92 /**</div><div id="93" class="line none">   93  * If a + b overflows, returns AWS_OP_ERR; otherwise adds</div><div id="94" class="line none">   94  * a + b, returns the result in *r, and returns AWS_OP_SUCCESS.</div><div id="95" class="line none">   95  */</div><div id="96" class="line none">   96 AWS_STATIC_IMPL int <a href="math.cbmc.inl.html#96">aws_add_u32_checked</a>(uint32_t a, uint32_t b, uint32_t *<a href="../../../../sources/openssl/ec_override.c.html#282">r</a>) {</div><div id="97" class="line none">   97     if (__CPROVER_overflow_plus(a, b))</div><div id="98" class="line none">   98         return <a href="error.inl.html#17">aws_raise_error</a>(<a href="error.h.html#148">AWS_ERROR_OVERFLOW_DETECTED</a>);</div><div id="99" class="line none">   99     *<a href="../../../../sources/openssl/ec_override.c.html#282">r</a> = a + b;</div><div id="100" class="line none">  100     return <a href="error.h.html#15">AWS_OP_SUCCESS</a>;</div><div id="101" class="line none">  101 }</div><div id="102" class="line none">  102 </div><div id="103" class="line none">  103 #pragma CPROVER check pop</div><div id="104" class="line none">  104 </div><div id="105" class="line none">  105 AWS_EXTERN_C_END</div><div id="106" class="line none">  106 </div><div id="107" class="line none">  107 #endif /* AWS_COMMON_MATH_CBMC_INL */</div>
</div>
</body>
</html>
